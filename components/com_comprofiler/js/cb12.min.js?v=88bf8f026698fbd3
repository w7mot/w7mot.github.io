function cbsaveorder(e,t,n,i,s,c){cbCheckAllRowsAndSubTask(e,t,n,s,c);cbsubmitform(i)}function cbCheckAllRowsAndSubTask(e,t,n,i,s){if(!n){n="cb"}f=cbParentForm(e);for(var c=0;c<t;c++){box=f.elements[n+c];if(box.checked==false){box.checked=true}}if(i&&s){f.elements[i].value=s}}function cbToggleAll(tgl,n,fldName){if(!fldName){fldName="cb"}var frm=tgl.form;var checked=0;for(i=0;i<n;i++){cb=eval("frm."+fldName+i);if(cb){cb.checked=tgl.checked;if(tgl.checked==true){checked++}}}if(typeof frm.boxchecked!="undefined"){frm.boxchecked.value=checked}return true}function cbParentForm(e){var t;if(e==window){t=window.event.srcElement}else{t=e}while(t){t=t.parentNode;if(t.nodeName=="FORM"){break}}return t}function cbIsChecked(e){if(e==true){document.adminForm.boxchecked.value++}else{document.adminForm.boxchecked.value--}}function cbListItemTask(e,t,n,s,c,o){var a=cbParentForm(e);if(e&&a){var l=new RegExp("^"+c+"[0-9]+$");for(i=0;i<a.elements.length;i++){cbx=a.elements[i];if(cbx.type!="checkbox"||!l.test(cbx.id)){continue}if(cbx.id==c+o){cbx.checked=true}else{cbx.checked=false}}if(n&&s){a.elements[n].value=s}submitbutton(t)}return false}function cbDoListTask(e,t,n,s,c){var o=document.forms["adminForm"];if(e){var a=false;for(i=0;true;i++){cbx=o.elements[c+i];if(!cbx){break}if(cbx.checked){a=true;break}}if(a){if(n&&s){if(s=="deleterows"){if(!confirm("Are you sure you want to delete selected items ?")){return false}}o.elements[n].value=s}submitbutton(t)}else{alert("no items selected")}}return false}function cbDoSubTask(e,t,n,i){var s=document.forms["adminForm"];if(e){if(n&&i){s.elements[n].value=i}submitbutton(t)}return false}function cbhideMainMenu(){if(document.adminForm.hidemainmenu){document.adminForm.hidemainmenu.value=1}}function submitbutton(e){cbsubmitform(e);return false}function cbsubmitform(e){if(e.indexOf("=")==-1){if(document.forms["adminForm"].elements["task"]){document.forms["adminForm"].elements["task"].value=e}else if(document.forms["adminForm"].elements["view"]){document.forms["adminForm"].elements["view"].value=e}}else{var t=e.split("&");for(var n=0;n<t.length;n++){var i=t[n].split("=");if(typeof document.forms["adminForm"].elements[i[0]]=="undefined"&&typeof cbjQuery!="undefined"){cbjQuery('<input type="hidden" />').attr("name",i[0]).attr("value",i[1]).appendTo(cbjQuery(document.forms["adminForm"]))}document.forms["adminForm"].elements[i[0]].value=i[1]}}if(typeof cbjQuery!="undefined"){cbjQuery(document.forms["adminForm"]).submit()}else{if(typeof document.forms["adminForm"]!="undefined"){try{document.forms["adminForm"].onsubmit()}catch(e){}}document.forms["adminForm"].submit()}}function cbAddEvent(e,t,n){if(e.addEventListener){e.addEventListener(t,n,true);return true}else if(e.attachEvent){var i=e.attachEvent("on"+t,n);return i}else{return false}}const cbHideFields={};const cbHideFieldsMap={};function cbParamCondition(e,t,n,i=[],s=[],c={},o=null,a={}){let l;if(t.type==="radio"||t.type==="checkbox"){const n=[];e.querySelectorAll('input[type="'+t.type+'"]').forEach((e=>{if(e.checked){n.push(e.value)}}));l=n.join("|*|")}else if(t.type==="select-multiple"){const e=[];for(const n of t.options){if(n.selected){e.push(n.value)}}l=e.join("|*|")}else{l=t.value}let d=false;for(const r of n){const n=r.operator;const u=r.value;let f=false;switch(n){case"=":case"==":f=l==u;break;case"===":f=l===u;break;case"<>":case"!=":f=l!=u;break;case"!==":f=l!==u;break;case">=":f=l>=u;break;case"<=":f=l<=u;break;case">":f=l>u;break;case"<":f=l<u;break;case"empty":f=!l.length;break;case"!empty":f=l.length;break;case"contains":if(l===""){f=l===u}else if(l.includes("|*|")){f=l.split("|*|").includes(u)}else{f=l.includes(u)}break;case"!contains":if(l===""){f=l!==u}else if(l.includes("|*|")){f=!l.split("|*|").includes(u)}else{f=!l.includes(u)}break;case"in":if(u===""){f=u!==l}else if(u.includes("|*|")){f=u.split("|*|").includes(l)}else{f=u.includes(l)}break;case"!in":if(u===""){f=u!==l}else if(u.includes("|*|")){f=!u.split("|*|").includes(l)}else{f=!u.includes(l)}break;case"regexp":if(u===""){f=u===l}else{try{f=new RegExp(u).test(l)}catch(e){}}break;case"!regexp":if(u===""){f=u!==l}else{try{f=!new RegExp(u).test(l)}catch(e){}}break;case"evaluate":if("cbPreviousValue"in t&&t.cbPreviousValue!==l){d=true}t.cbPreviousValue=l;break;default:console.warn("xml if:showhide unknown "+n+" operator.");break}if(f){e:for(const t of r.show){if(s.includes(t)){continue}if(o!=="init"){if(o!=="or"&&t in cbHideFields){if(!(t in a)){const e=document.getElementById(t);if(!e){continue}const n=document.getElementById(cbHideFields[t].element);if(n!==null){cbParamCondition(e,n,cbHideFields[t].conditions,i,s,c,"nested",a)}else{cbParamInputs(e).forEach((n=>{cbParamCondition(e,n,cbHideFields[t].conditions,i,s,c,"nested",a)}))}a[t]={show:i,hide:s,set:c}}if(a[t].hide.includes(t)){continue}}if(o==="change"&&t in cbHideFieldsMap&&cbHideFieldsMap[t].length>1){for(const n of cbHideFieldsMap[t]){if(n===e.id||!(n in cbHideFields)){continue}if(!(n in a)){const e=document.getElementById(n);if(!e){continue}const t=document.getElementById(cbHideFields[n].element);const i=[];const s=[];const c=[];if(t!==null){cbParamCondition(e,t,cbHideFields[n].conditions,i,s,c,"or",a)}else{cbParamInputs(e).forEach((t=>{cbParamCondition(e,t,cbHideFields[n].conditions,i,s,c,"or",a)}))}a[n]={show:i,hide:s,set:c}}if(a[n].hide.includes(t)){continue e}}}}if(i.includes(t)){continue}i.push(t)}}else{for(const e of r.show){if(s.includes(e)){continue}s.push(e)}for(const e of r.set){c[e.element]=e.value}}}return d}function cbParamShowHide(e=[],t=[],n={}){for(const n of e){if(t.includes(n)){continue}const e=document.getElementById(n);if(!e){continue}if(e.type==="radio"||e.type==="checkbox"){e.parentElement.classList.remove("hidden")}else{e.classList.remove("hidden");if(e.tagName.toLowerCase()==="option"){e.disabled=false}}e.classList.remove("cbDisplayDisabled");e.querySelectorAll("input,select,textarea").forEach((e=>{e.classList.remove("cbValidationDisabled");if(e.classList.contains("cbInputDisabled")){e.classList.remove("cbInputDisabled");e.disabled=false}}))}for(const e of t){const t=document.getElementById(e);if(!t){continue}if(t.type==="radio"||t.type==="checkbox"){t.parentElement.classList.add("hidden");t.checked=false}else{t.classList.add("hidden");if(t.tagName.toLowerCase()==="option"){t.selected=false;t.disabled=true}}t.classList.add("cbDisplayDisabled");t.querySelectorAll("input,select,textarea").forEach((e=>{e.classList.add("cbValidationDisabled");if(!Object.keys(n).length){if(!e.disabled){e.classList.add("cbInputDisabled");e.disabled=true}return}let t=e.id;if(e.type==="radio"||e.type==="checkbox"){t=t.replace(/_+cbf[0-9]+$/g,"")}else if(e.type==="select-multiple"){t=t.replace(/_+$/g,"")}if(!(t in n)){if(!e.disabled){e.classList.add("cbInputDisabled");e.disabled=true}return}if(e.disabled){e.classList.remove("cbInputDisabled");e.disabled=false}const i=n[t];if(e.type==="radio"||e.type==="checkbox"){e.checked=i.split("|*|").includes(e.value)}else if(e.type==="select-multiple"){const t=i.split("|*|");for(const n of e.options){n.selected=t.includes(n.value);n.disabled=false}}else{e.value=i}e.dispatchEvent(new Event("change"))}))}}function cbParamChange(e,t,n){const i=[];const s=[];const c={};const o=cbParamCondition(e,t,n,i,s,c,"change");cbParamShowHide(i,s,c);if(o){const t=e.closest("form");if(t){t.submit()}}}function cbParamInputs(e){let t=e.querySelectorAll("select");if(!t.length){t=e.querySelectorAll("textarea")}if(!t.length){t=e.querySelectorAll("input")}return t}function cbInitFields(e){const t=[];const n=[];const i={};for(const s in e){const c=document.getElementById(s);if(c===null){console.warn("xml if:showhide "+s+" is undefined.");continue}for(const t of e[s].conditions){for(const e of t.show){if(!(e in cbHideFieldsMap)){cbHideFieldsMap[e]=[]}if(cbHideFieldsMap[e].includes(s)){continue}cbHideFieldsMap[e].push(s)}}const o=o=>{if(o.type==="hidden"){return}const a=()=>{cbParamChange(c,o,e[s].conditions)};o.addEventListener("cbParamChange",a);if(o.type==="text"||o.type==="email"||o.type==="number"||o.type==="password"||o.type==="search"||o.type==="tel"||o.type==="url"||o.tagName.toLowerCase()==="textarea"){o.addEventListener("keyup",a)}o.addEventListener("change",a);cbParamCondition(c,o,e[s].conditions,t,n,i,"init")};const a=document.getElementById(e[s].element);if(a!==null){o(a)}else{cbParamInputs(c).forEach((e=>{o(e)}))}}cbParamShowHide(t,n,i)}window.addEventListener("load",(()=>{cbInitFields(cbHideFields)}));function CBgetHttpRequestInstance(){var e=false;if(window.XMLHttpRequest){e=new XMLHttpRequest;if(e.overrideMimeType){e.overrideMimeType("text/xml")}}else if(window.ActiveXObject){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}}return e}function CBmakeHttpRequest(e,t,n,i,s){if(arguments.length<5||s==null){s=CBgetHttpRequestInstance()}if(!s){return false}s.onreadystatechange=function(){c(s)};if(i==null){s.open("GET",e,true);s.send(null)}else{s.open("POST",e,true);s.setRequestHeader("Content-type","application/x-www-form-urlencoded");s.setRequestHeader("Content-length",i.length);s.send(i)}function c(e){if(e.readyState==4){if(e.status==200&&e.responseText.length>0&&e.responseText.length<1025){document.getElementById(t).innerHTML=e.responseText}else if(n.length>0){document.getElementById(t).innerHTML=n}else{document.getElementById(t).innerHTML=""}e=null}}return true}